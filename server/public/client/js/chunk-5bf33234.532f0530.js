(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5bf33234"],{3605:function(e,t,r){"use strict";r("e195")},"39d0":function(e,t,r){},"45c2":function(e,t,r){"use strict";r("4c36")},"4c36":function(e,t,r){},a876:function(e,t){e.exports=({OverlayView:e=google.maps.OverlayView,...t})=>{class r extends e{constructor(){super(),this.latlng=t.latlng,this.html=t.html,this.setMap(t.map)}createDiv(){this.div=document.createElement("div"),this.div.style.position="absolute",this.html&&(this.div.innerHTML=this.html),google.maps.event.addDomListener(this.div,"click",e=>{google.maps.event.trigger(this,"click")})}appendDivToOverlay(){const e=this.getPanes();e.overlayImage.appendChild(this.div)}positionDiv(){const e=this.getProjection().fromLatLngToDivPixel(this.latlng);let t=25;e&&(this.div.style.left=e.x-t+"px",this.div.style.top=e.y-t+"px")}draw(){this.div||(this.createDiv(),this.appendDivToOverlay()),this.positionDiv()}remove(){this.div&&(this.div.parentNode.removeChild(this.div),this.div=null)}getPosition(){return this.latlng}getDraggable(){return!1}}return new r}},afbb:function(e,t,r){"use strict";r("39d0")},c04c:function(e,t,r){e.exports=r.p+"img/empty.79327d79.svg"},daab:function(e,t,r){"use strict";r.r(t);var n=r("5530"),o=(r("b0c0"),r("4de4"),r("d3b7"),r("f2bf")),a={class:"catalog"},c={key:0,class:"selection-title"};function l(e,t,r,l,i,s){var u=Object(o["resolveComponent"])("g-icon"),p=Object(o["resolveComponent"])("router-link"),d=Object(o["resolveComponent"])("c-filter"),m=Object(o["resolveComponent"])("l-list"),f=Object(o["resolveComponent"])("l-map");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",a,[s.selection?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",c,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(s.selection.name),1),Object(o["createVNode"])(p,{class:"close",to:{name:"catalog",query:Object(n["a"])({},e.$route.query)}},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(u,{name:"ui/close"})]})),_:1},8,["to"])])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(d,{is_catalog:!0,onLoad:s.load},null,8,["onLoad"]),"list"==s.filter.view?(Object(o["openBlock"])(),Object(o["createBlock"])(m,{key:1,complexes:e.$store.state.catalog.complexes},null,8,["complexes"])):Object(o["createCommentVNode"])("",!0),"map"==s.filter.view?(Object(o["openBlock"])(),Object(o["createBlock"])(f,{key:2,complexes:e.$store.state.catalog.complexes},null,8,["complexes"])):Object(o["createCommentVNode"])("",!0)])}var i=r("1da1"),s=(r("a9e3"),r("ddb0"),r("4e82"),r("ac1f"),r("841c"),r("7db0"),r("96cf"),r("40b2")),u=function(e){return Object(o["pushScopeId"])("data-v-1fb3f7a8"),e=e(),Object(o["popScopeId"])(),e},p={class:"sort"},d=u((function(){return Object(o["createElementVNode"])("div",{class:"label"},"Сортировать:",-1)})),m=["onClick"],f={class:"list"},b={key:0,class:"empty"};function v(e,t,r,n,a,c){var l=Object(o["resolveComponent"])("g-icon"),i=Object(o["resolveComponent"])("i-complex");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createElementVNode"])("div",p,[d,(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sort,(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])(["sort-item",{active:e.value.key==c.filter.sort.key,down:1==c.filter.sort.dir,up:-1==c.filter.sort.dir}]),key:t,onClick:function(t){return c.setSort(e.value)}},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.text),1),Object(o["createVNode"])(l,{name:"ui/chevron"})],10,m)})),128))]),Object(o["createElementVNode"])("div",f,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(r.complexes,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(i,{complex:e,bedrooms:!0},null,8,["complex"])})),256)),0==r.complexes.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",b,"Результаты не найдены")):Object(o["createCommentVNode"])("",!0)])],64)}var y=r("24de"),h={props:{complexes:Array},data:function(){return{sort:[{text:"Сначала новые",value:{key:"created",dir:1}},{text:"Цене",value:{key:"price",dir:1}},{text:"Цене за метр",value:{key:"rate",dir:1}}]}},methods:{setSort:function(e){this.filter.sort.key==e.key?this.filter.sort.dir=-1*this.filter.sort.dir:this.filter.sort=e,this.$store.dispatch("catalog/filter")}},computed:{filter:function(){return this.$store.state.catalog.filter}},components:{iComplex:y["a"]}},O=(r("afbb"),r("6b0d")),j=r.n(O);const g=j()(h,[["render",v],["__scopeId","data-v-1fb3f7a8"]]);var k=g,x={class:"map-container"},w={class:"list"},C={key:0,class:"empty"},T={class:"catalog-map-window-inner"},B={class:"options"},N={class:"info"},V={class:"name"},E=Object(o["createTextVNode"])("Посмотреть");function _(e,t,r,n,a,c){var l=Object(o["resolveComponent"])("i-complex"),i=Object(o["resolveComponent"])("g-favorite"),s=Object(o["resolveComponent"])("g-icon"),u=Object(o["resolveComponent"])("router-link"),p=Object(o["resolveComponent"])("GMapInfoWindow"),d=Object(o["resolveComponent"])("GMapMarker"),m=Object(o["resolveComponent"])("GMapCluster"),f=Object(o["resolveComponent"])("GMapMap");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",x,[Object(o["createElementVNode"])("div",w,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.rendered,(function(r){return Object(o["openBlock"])(),Object(o["createBlock"])(l,{key:r.id,complex:r,horizontal:!0,onClick:Object(o["withModifiers"])((function(t){return e.opened=r.id}),["prevent","stop"]),onMouseover:function(t){return e.hover=r.id},onMouseleave:t[0]||(t[0]=function(t){return e.hover=null})},null,8,["complex","onClick","onMouseover"])})),128)),0==e.rendered.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",C,"Результаты не найдены")):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])(f,{class:"map",center:{lat:51.093048,lng:6.84212},zoom:15,ref:"map",options:e.mapOptions,onIdle:c.redraw_complexes},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(m,{class:"catalog-map-cluster",zoomOnClick:!0,styles:[{width:40,height:40}]},{default:Object(o["withCtx"])((function(){return[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.rendered,(function(r){return Object(o["openBlock"])(),Object(o["createBlock"])(d,{class:"catalog-map-marker2",key:r.id,position:r.coordinates,optimized:!1,label:{text:"от ".concat(parseInt(r.min_price/Math.pow(10,6))," млн"),className:e.hover===r.id?"catalog-map-marker-active":"catalog-map-marker"},icon:e.mapIcon,onClick:function(t){return e.opened=r.id}},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(p,{class:"catalog-map-window",opened:r.id==e.opened,closeclick:!1},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("div",T,[Object(o["createElementVNode"])("div",B,[Object(o["createVNode"])(i,{id:r.id,onClick:Object(o["withModifiers"])((function(e){return null}),["stop"])},null,8,["id","onClick"]),Object(o["createElementVNode"])("div",{class:"close",onClick:t[1]||(t[1]=Object(o["withModifiers"])((function(t){return e.opened=null}),["stop","prevent"]))},[Object(o["createVNode"])(s,{name:"ui/close"})])]),Object(o["createElementVNode"])("div",{class:"img",style:Object(o["normalizeStyle"])({backgroundImage:"url(".concat(r.image,")")})},null,4),Object(o["createElementVNode"])("div",N,[Object(o["createElementVNode"])("div",V,Object(o["toDisplayString"])(r.name),1),Object(o["createVNode"])(u,{class:"open",to:{name:"complex",params:{id:r.key}},target:"_blank"},{default:Object(o["withCtx"])((function(){return[E]})),_:2},1032,["to"])])])]})),_:2},1032,["opened"])]})),_:2},1032,["position","label","icon","onClick"])})),128))]})),_:1})]})),_:1},8,["center","options","onIdle"])])}r("a4d3"),r("e01a"),r("d28b"),r("3ca3"),r("d9e2");var I=r("06c5");function R(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Object(I["a"])(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,a=e},f:function(){try{c||null==r["return"]||r["return"]()}finally{if(l)throw a}}}}r("d81d"),r("a876");var L={props:{complexes:Array},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.rendered=e.complexes,t.next=3,e.$gmapApiPromiseLazy();case 3:return r=t.sent,n=r.maps,t.next=7,e.$refs.map.$mapPromise;case 7:return o=t.sent,e.api=n,e.map=o,t.next=12,e.fitBounds();case 12:case"end":return t.stop()}}),t)})))()},data:function(){return{mapOptions:{zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,gestureHandling:"greedy",styles:[{featureType:"all",elementType:"geometry.fill",stylers:[{weight:"2.00"}]},{featureType:"all",elementType:"geometry.stroke",stylers:[{color:"#9c9c9c"}]},{featureType:"all",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#eeeeee"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#7b7b7b"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#c8d7d4"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#070707"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]}]},mapIcon:{url:r("c04c"),scaledSize:{width:100,height:40},labelOrigin:{x:50,y:0}},clusterOptions:{clusterClass:"catalog-map-cluster"},api:null,map:null,opened:null,rendered:[],hover:null}},watch:{complexes:function(){this.rendered=this.complexes,this.fitBounds()}},methods:{fitBounds:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.api&&e.map){t.next=2;break}return t.abrupt("return");case 2:r=new e.api.LatLngBounds,n=R(e.rendered);try{for(n.s();!(o=n.n()).done;)a=o.value,r.extend(new e.api.LatLng(a.coordinates.lat,a.coordinates.lng))}catch(c){n.e(c)}finally{n.f()}return t.next=7,e.map.fitBounds(r);case 7:e.map.getZoom()>12&&e.map.setZoom(12);case 8:case"end":return t.stop()}}),t)})))()},redraw_complexes:function(){var e=this.map.getBounds();console.log("REDRAW"),this.rendered=this.complexes.filter((function(t){var r=t.coordinates.lat,n=t.coordinates.lng;return n>e.Qa.h&&n<e.Qa.j&&r>e.ub.h&&r<e.ub.j}))}},components:{iComplex:y["a"]}};r("45c2");const M=j()(L,[["render",_],["__scopeId","data-v-5ebae37c"]]);var $=M,S={beforeRouteEnter:function(e,t,r){return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.setFilter();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))()},beforeRouteUpdate:function(e,t){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.name==t.name){n.next=3;break}return n.next=3,r.setFilter();case 3:case"end":return n.stop()}}),n)})))()},beforeUnmount:function(){this.$store.state.catalog.filter.view="list"},props:{selection_id:[String,Number]},data:function(){return{}},methods:{load:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("catalog/filter");case 2:case"end":return t.stop()}}),t)})))()},setFilter:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$store.state.catalog.filter,n=e.$route.query,console.log("route",n),n.bedrooms&&(r.bedrooms="string"===typeof n.bedrooms?[n.bedrooms]:n.bedrooms),n.deadline&&(r.deadline.choosen="string"===typeof n.deadline?[n.deadline]:n.deadline),n.class&&(r.class.choosen="string"===typeof n.class?[n.class]:n.class),n.done&&(r.done=JSON.parse(n.done)),n.area?r.area.values=[parseInt(n.area[0]),parseInt(n.area[1])]:r.area.values=[r.area.min,r.area.max],n.price?r.price.values=[parseInt(n.price[0]),parseInt(n.price[1])]:r.price.values=[r.price.min,r.price.max],r.sort.key=n.sort_key||r.sort.key,r.sort.dir=n.sort_dir||r.sort.dir,r.search=n.search||r.search,r.view=n.view||r.view,r.selection=e.selection_id,r.loaded=!0,t.next=17,e.$store.dispatch("catalog/filter");case 17:case"end":return t.stop()}}),t)})))()}},computed:{filter:function(){return this.$store.state.catalog.filter},selection:function(){var e=this;return this.selection_id?this.$store.state.catalog.selections.find((function(t){return t.key==e.selection_id})):null}},components:{cFilter:s["a"],lList:k,lMap:$}};r("3605");const D=j()(S,[["render",l],["__scopeId","data-v-a37d0eb4"]]);t["default"]=D},e195:function(e,t,r){}}]);
//# sourceMappingURL=chunk-5bf33234.532f0530.js.map